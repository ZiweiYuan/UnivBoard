{% extends 'base.html' %}

{% block title %}Welcome to UnivBoard{% endblock title %}

{% block navbar %}
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <img src="{{ url_for('static', filename='images/school.svg') }}" height="35" width="35" style="margin-right: 5px">
    <a class="navbar-brand" href="{{ url_for('index') }}">UnivBoard</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
            <a class="nav-item nav-link" href="{{ url_for('index') }}">Search</a>
            <a class="nav-item nav-link" href="{{ url_for('about') }}">About</a>
            <a class="nav-item nav-link" href="https://github.com/ZiweiYuan/UnivBoard">Github</a>
        </div>
    </div>
</nav>
{% endblock navbar %}

{% block content %}
<section>
    <div class="container-fluid">
        <div class="row bg-img justify-content-center">
            <div class="card search-card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active text-secondary" href="#program" data-toggle="tab">Programs</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-secondary" href="#course" data-toggle="tab">Courses</a>
                        </li>
                    </ul>
                </div>
                <div class="card-body tab-content">
                    <form action="{{ url_for('search_programs') }}" method="post" class="tab-pane fade show active" id="program" role="form" onsubmit="submit">
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <label for="search-input">Keyword</label>
                                <input type="search" class="form-control" id="keywords" name="keywords" placeholder="Computer" value="{{ request.form['keywords'] }}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="smc" value="smc" name="univ">
                                    <label class="form-check-label" for="smc" style="margin-right: 5px;">Santa Monica Coll.</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="msmu" value="msmu" name="univ">
                                    <label class="form-check-label" for="msmu" style="margin-right: 5px;">Mount Saint Mary’s Univ.</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="scu" value="scu" name="univ">
                                    <label class="form-check-label" for="scu" style="margin-right: 5px;">Santa Clara Univ.</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <select class="selectpicker form-control" multiple data-live-search="true" id="department" title="Please first choose one or more universities" data-actions-box="true" data-dropup-auto="false" name="depart" data-size="5">
                                </select>
                            </div>
                        </div>
                        <div class="form-row justify-content-center">
                            <button type="submit" class="btn btn-outline-info">Search</button>
                        </div>
                    </form>
                    <form action="{{ url_for('search_courses') }}" method="post" class="tab-pane fade show" id="course" role="form" onsubmit="submit">
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <label for="search-input">Keyword</label>
                                <input type="search" class="form-control" id="keywords2" name="keywords2" placeholder="Computer" value="{{ request.form['keywords2'] }}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <label>Search field: </label>
                                <div class="form-check form-check-inline">
                                  <input class="form-check-input" type="radio" id="title" name="field" value="title" checked>
                                  <label class="form-check-label" for="title">
                                    course title (e.g. computer)
                                  </label>
                                </div>
                                <div class="form-check form-check-inline">
                                  <input class="form-check-input" type="radio" id="initial" name="field" value="initial">
                                  <label class="form-check-label" for="initial">
                                    course initial (e.g. LAW 114)
                                  </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="smc" value="smc" name="univ2">
                                    <label class="form-check-label" for="smc" style="margin-right: 5px;">Santa Monica Coll.</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="msmu" value="msmu" name="univ2">
                                    <label class="form-check-label" for="msmu" style="margin-right: 5px;">Mount Saint Mary’s Univ.</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="scu" value="scu" name="univ2">
                                    <label class="form-check-label" for="scu" style="margin-right: 5px;">Santa Clara Univ.</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                <select class="selectpicker form-control" multiple data-live-search="true" id="department2" title="Please first choose one or more universities" data-actions-box="true" data-dropup-auto="false" name="depart2" data-size="5">
                                </select>
                            </div>
                        </div>
                        <div class="form-row justify-content-center">
                            <button type="submit" class="btn btn-outline-info">Search</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

{% block results %}
{% endblock results%}

{% endblock content %}

{% block footer %}
<footer>
    <div class="container-fluid bg-light">
      <div class="row justify-content-center">
        <div class="col-md-12 text-center navbar-text">
          <p class="text-sm">© 2019 UnivBoard.  All rights reserved.</p>
        </div>
      </div>
    </div>
</footer>
{% endblock footer %}

{% block scripts %}
<script>
$('input[name=univ]').change(function(){

    if($(this).is(':checked')) {
        switch($(this).val()) {
            case "smc":
                {% for item in smc_depart %}
                    createOption(document.getElementById("department"), "{{ item['key'] }}", $(this).val());
                {% endfor %}
                break;
            case "msmu":
                {% for item in msmu_depart %}
                    createOption(document.getElementById("department"), "{{ item['key'] }}", $(this).val());
                {% endfor %}
                break;
            case "scu":
                {% for item in scu_depart %}
                    createOption(document.getElementById("department"), "{{ item['key'] }}", $(this).val());
                {% endfor %}
                break;
        }
    }
    else {
        $('#department option[label="'+$(this).val()+'"]').remove();
    }
    
    $("#department option").val(function(idx, val) {
      $(this).siblings('[text="'+ val +'"]').remove();
        return val;
    });
    $('#department').selectpicker('refresh');
});
                 
$('input[name=univ2]').change(function(){

    if($(this).is(':checked')) {
        switch($(this).val()) {
            case "smc":
                {% for item in smc_depart %}
                    createOption(document.getElementById("department2"), "{{ item['key'] }}", $(this).val());
                {% endfor %}
                break;
            case "msmu":
                {% for item in msmu_depart %}
                    createOption(document.getElementById("department2"), "{{ item['key'] }}", $(this).val());
                {% endfor %}
                break;
            case "scu":
                {% for item in scu_depart %}
                    createOption(document.getElementById("department2"), "{{ item['key'] }}", $(this).val());
                {% endfor %}
                break;
        }
    }
    else {
        $('#department2 option[label="'+$(this).val()+'"]').remove();
    }
    
    $("#department2 option").val(function(idx, val) {
      $(this).siblings('[text="'+ val +'"]').remove();
        return val;
    });
    $('#department2').selectpicker('refresh');
});
                 
function createOption(ddl, text, label) {
    var opt = document.createElement("Option");
    opt.text = text;
    opt.label = label;
    ddl.options.add(opt);
}
</script>
{% endblock scripts %}